#!/usr/bin/make -f

export DH_VERBOSE=1
# Turn on all hardening flags, as we're a networked daemon.
export DEB_BUILD_MAINT_OPTIONS = hardening=+all
# see EXAMPLES in dpkg-buildflags(1) and read /usr/share/dpkg/*
DPKG_EXPORT_BUILDFLAGS = 1
include /usr/share/dpkg/default.mk

%:
	dh $@

override_dh_auto_build:
	PATH=../go/bin:$$PATH;./build.sh

override_dh_auto_configure:

override_dh_auto_install:
	mkdir -p $(CURDIR)/debian/lightningstream/usr/bin/
	install -o root -g root bin/lightningstream $(CURDIR)/debian/lightningstream/usr/bin/
	mkdir -p $(CURDIR)/debian/lightningstream/etc/lightningstream
	install -o root -g root files/lightningstream.yaml $(CURDIR)/debian/lightningstream/etc/lightningstream/lightningstream.example.yaml

override_dh_installsystemd:
	dh_installsystemd --no-start -plightningstream --name=lightningstream

override_dh_install:

override_dh_auto_test:

override_dh_builddeb:
	dh_builddeb -- -Zgzip
